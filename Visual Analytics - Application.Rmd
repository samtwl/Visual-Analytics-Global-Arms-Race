---
title: "Arms Trade"
output: 
  flexdashboard::flex_dashboard:
    theme: united
    orientation: rows
    social: menu
    css: style.css
runtime: shiny
---

<style>                     
.navbar {
  font-size:11px;
}

</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)
knitr::opts_knit$set(root.dir = 'C:/Users/Selvi/Desktop/ISSS608 Visual Analytics Group 14 Project')
```

```{r, include=FALSE}
#Loading Packages
packages = c('treemap', 'd3treeR', 'dplyr', 'shiny', 'flexdashboard', 'circlize', 'tidyverse', 'visNetwork', 'data.table', 'plotly', 'janitor', 'tidyr', 'ggplot2', 'rsconnect', 'htmltools', 'htmlwidgets', 'metricsgraphics', 'RColorBrewer', 'ggridges', 'viridis', 'sf', 'leaflet', 'tmap', 'crosstalk')
for (p in packages){
  if(!require(p, character.only = T)){
    install.packages(p)
  }
  library(p, character.only = T)
}

devtools::install_github("mattflor/chorddiag")
library(chorddiag)
```

```{r, include=FALSE}
#Reading World Map Data
worldmap = st_read(dsn = "data/world_shape_file", layer = "TM_WORLD_BORDERS_SIMPL-0.3")

#Reading Data for GPI
gpi <- read_csv("data/GPI.csv") %>%
  filter(Year == 2018)

gpi$Country <- recode(gpi$Country, 
                      'Cote d\' Ivoire' = 'Cote d\'Ivoire',
                      'Iran' = 'Iran (Islamic Republic of)',
                      'Kyrgyz Republic' = 'Kyrgyzstan',
                      'Laos' = 'Lao People\'s Democratic Republic',
                      'Libya' = 'Libyan Arab Jamahiriya',
                      'Macedonia (FYR)' = 'The former Yugoslav Republic of Macedonia',
                      'Moldova' = 'Republic of Moldova',
                      'Myanmar' = 'Burma',
                      'North Korea' = 'Korea, Democratic People\'s Republic of',
                      'Republic of the Congo' = 'Democratic Republic of the Congo',
                      'South Korea' = 'Korea, Republic of',
                      'Syria' = 'Syrian Arab Republic',
                      'Tanzania' = 'United Republic of Tanzania',
                      'The Gambia' = 'Gambia',
                      'United States of America' = 'United States',
                      'Vietnam' = 'Viet Nam')

gpimap <- left_join(worldmap, gpi, by = c('NAME' = 'Country')) %>%
  arrange(desc(Rank)) #%>%
  #slice(1:41)

#Loading data for Overview Line Graph
top100imports9317 <- read_csv("data/top100importsbycountries9317.csv")

#Data Manipulation for Overview Line Graph
top100imports9317_gathered <- gather(top100imports9317, "year", "amount", 3:28) %>%
  slice(1:2475)

#Data Manipulation for Overview Map Graph
top100imports9317map <- read.csv("data/top100importsbycountries9317.csv")

top100imports9317map$Recipient <- recode(top100imports9317map$Recipient,
                                        'South Korea' = 'Korea, Republic of',
                                        'North Korea' = 'Korea, Democratic People\'s Republic of',
                                        'Libya' = 'Libyan Arab Jamahiriya',
                                        'Iran' = 'Iran (Islamic Republic of)',
                                        'UAE' = 'United Arab Emirates',
                                        'Syria' = 'Syrian Arab Republic',
                                        'Myanmar' = 'Burma',
                                        'Brunei' = 'Brunei Darussalam',
                                        'Tanzania' = 'United Republic of Tanzania')

worldmap_joined_top100imports <- left_join(worldmap, top100imports9317map, by = c('NAME' = 'Recipient')) %>%
  filter(!is.na(Region))

#Shared Data for Overview
sd <- worldmap_joined_top100imports %>%
  select(-`X1993.2017`) %>%
  gather(year, amount, 13:37) 

sd$year <- gsub("X", "", sd$year)

sd <- select(sd, LON, LAT, NAME, Region, year, amount, geometry)


overviewshareddata_SSA <- SharedData$new(filter(sd, Region == "Sub-Saharan Africa"), ~NAME, group = "Choose a Country")

overviewshareddata_SA <- SharedData$new(filter(sd, Region == "South Asia"), ~NAME, group = "Choose a Country")

overviewshareddata_EAP <- SharedData$new(filter(sd, Region == "East Asia & Pacific"), ~NAME, group = "Choose a Country")

overviewshareddata_ECA <- SharedData$new(filter(sd, Region == "Europe & Central Asia"), ~NAME, group = "Choose a Country")

overviewshareddata_LAC <- SharedData$new(filter(sd, Region == "Latin America & Caribbean"), ~NAME, group = "Choose a Country")

overviewshareddata_MENA <- SharedData$new(filter(sd, Region == "Middle East & North Africa"), ~NAME, group = "Choose a Country")

overviewshareddata_NA <- SharedData$new(filter(sd, Region == "North America"), ~NAME, group = "Choose a Country")




```



```{r, include=FALSE}
###Preliminary Chord Diagram Code###
##1993 TO 1997##
#Sub-Saharan Africa 9397#
chordSSA9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SSA9397_colvalue1 <- colnames(select(chordSSA9397_prelim1, -from))

SSA9397_df1 <- cbind(data.frame(from = colnames(select(chordSSA9397_prelim1, -from, -Ethiopia, -`South.Africa`))), setNames(lapply(SSA9397_colvalue1, function(x) x=0), SSA9397_colvalue1))

SSA9397_df2 <- rbind(chordSSA9397_prelim1,SSA9397_df1)

chordSSA9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SSA9397_colvalue2 <- colnames(select(chordSSA9397_prelim2, -to, -Ethiopia, -`South Africa`))

SSA9397_df3 <- select(cbind(select(SSA9397_df2, from), setNames(lapply(SSA9397_colvalue2, function(x) x=0), SSA9397_colvalue2)), -from)

chordSSA9397_agg <- cbind(SSA9397_df2,SSA9397_df3)
chordSSA9397_agg <- chordSSA9397_agg[ ,sort(names(chordSSA9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()

#South Asia 9397#
chordSA9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SA9397_colvalue1 <- colnames(select(chordSA9397_prelim1, -from))

SA9397_df1 <- cbind(data.frame(from = colnames(select(chordSA9397_prelim1, -from, -Pakistan))), setNames(lapply(SA9397_colvalue1, function(x) x=0), SA9397_colvalue1))

SA9397_df2 <- rbind(chordSA9397_prelim1,SA9397_df1)

chordSA9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SA9397_colvalue2 <- colnames(select(chordSA9397_prelim2, -to, -Pakistan))

SA9397_df3 <- select(cbind(select(SA9397_df2, from), setNames(lapply(SA9397_colvalue2, function(x) x=0), SA9397_colvalue2)), -from)

chordSA9397_agg <- cbind(SA9397_df2,SA9397_df3)
chordSA9397_agg <- chordSA9397_agg[ ,sort(names(chordSA9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()

#East Asia & Pacific 9397#
chordEAP9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

EAP9397_colvalue1 <- colnames(select(chordEAP9397_prelim1, -from))

EAP9397_df1 <- cbind(data.frame(from = colnames(select(chordEAP9397_prelim1, -from, -North.Korea))), setNames(lapply(EAP9397_colvalue1, function(x) x=0), EAP9397_colvalue1))

EAP9397_df2 <- rbind(chordEAP9397_prelim1,EAP9397_df1)

chordEAP9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

EAP9397_colvalue2 <- colnames(select(chordEAP9397_prelim2, -to, -`North Korea`))

EAP9397_df3 <- select(cbind(select(EAP9397_df2, from), setNames(lapply(EAP9397_colvalue2, function(x) x=0), EAP9397_colvalue2)), -from)

chordEAP9397_agg <- cbind(EAP9397_df2,EAP9397_df3)
chordEAP9397_agg <- chordEAP9397_agg[ ,sort(names(chordEAP9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Europe & Central Asia 9397#
chordECA9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

ECA9397_colvalue1 <- colnames(select(chordECA9397_prelim1, -from))

ECA9397_df1 <- cbind(data.frame(from = colnames(select(chordECA9397_prelim1, -from, -Russia,-Turkey,-Ukraine))), setNames(lapply(ECA9397_colvalue1, function(x) x=0), ECA9397_colvalue1))

ECA9397_df2 <- rbind(chordECA9397_prelim1,ECA9397_df1)

chordECA9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

ECA9397_colvalue2 <- colnames(select(chordECA9397_prelim2, -to, -Russia,-Turkey,-Ukraine))

ECA9397_df3 <- select(cbind(select(ECA9397_df2, from), setNames(lapply(ECA9397_colvalue2, function(x) x=0), ECA9397_colvalue2)), -from)

chordECA9397_agg <- cbind(ECA9397_df2,ECA9397_df3)
chordECA9397_agg <- chordECA9397_agg[ ,sort(names(chordECA9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Latin America & Caribbean 9397#
chordLAC9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

LAC9397_colvalue1 <- colnames(select(chordLAC9397_prelim1, -from))

LAC9397_df1 <- cbind(data.frame(from = colnames(select(chordLAC9397_prelim1, -from))), setNames(lapply(LAC9397_colvalue1, function(x) x=0), LAC9397_colvalue1))

LAC9397_df2 <- rbind(chordLAC9397_prelim1,LAC9397_df1)

chordLAC9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

LAC9397_colvalue2 <- colnames(select(chordLAC9397_prelim2, -to))

LAC9397_df3 <- select(cbind(select(LAC9397_df2, from), setNames(lapply(LAC9397_colvalue2, function(x) x=0), LAC9397_colvalue2)), -from)

chordLAC9397_agg <- cbind(LAC9397_df2,LAC9397_df3)
chordLAC9397_agg <- chordLAC9397_agg[ ,sort(names(chordLAC9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Middle East & North Africa 9397#
chordMENA9397_prelim1 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

MENA9397_colvalue1 <- colnames(select(chordMENA9397_prelim1, -from))

MENA9397_df1 <- cbind(data.frame(from = colnames(select(chordMENA9397_prelim1, -from, -Egypt, -Israel, -Libya, -Saudi.Arabia, -Syria))), setNames(lapply(MENA9397_colvalue1, function(x) x=0), MENA9397_colvalue1))

MENA9397_df2 <- rbind(chordMENA9397_prelim1,MENA9397_df1)

chordMENA9397_prelim2 <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

MENA9397_colvalue2 <- colnames(select(chordMENA9397_prelim2, -to, -Egypt, -Israel, -Libya, -`Saudi Arabia`, -Syria))

MENA9397_df3 <- select(cbind(select(MENA9397_df2, from), setNames(lapply(MENA9397_colvalue2, function(x) x=0), MENA9397_colvalue2)), -from)

chordMENA9397_agg <- cbind(MENA9397_df2,MENA9397_df3)
chordMENA9397_agg <- chordMENA9397_agg[ ,sort(names(chordMENA9397_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#============================================================================#

##1998 TO 2002##
#Sub-Saharan Africa 9802#
chordSSA9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SSA9802_colvalue1 <- colnames(select(chordSSA9802_prelim1, -from))

SSA9802_df1 <- cbind(data.frame(from = colnames(select(chordSSA9802_prelim1, -from, -`South.Africa`))), setNames(lapply(SSA9802_colvalue1, function(x) x=0), SSA9802_colvalue1))

SSA9802_df2 <- rbind(chordSSA9802_prelim1,SSA9802_df1)

chordSSA9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SSA9802_colvalue2 <- colnames(select(chordSSA9802_prelim2, -to, -`South Africa`))

SSA9802_df3 <- select(cbind(select(SSA9802_df2, from), setNames(lapply(SSA9802_colvalue2, function(x) x=0), SSA9802_colvalue2)), -from)

chordSSA9802_agg <- cbind(SSA9802_df2,SSA9802_df3)
chordSSA9802_agg <- chordSSA9802_agg[ ,sort(names(chordSSA9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#South Asia 9802#
chordSA9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SA9802_colvalue1 <- colnames(select(chordSA9802_prelim1, -from))

SA9802_df1 <- cbind(data.frame(from = colnames(select(chordSA9802_prelim1, -from, -India))), setNames(lapply(SA9802_colvalue1, function(x) x=0), SA9802_colvalue1))

SA9802_df2 <- rbind(chordSA9802_prelim1,SA9802_df1)

chordSA9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SA9802_colvalue2 <- colnames(select(chordSA9802_prelim2, -to, -India))

SA9802_df3 <- select(cbind(select(SA9802_df2, from), setNames(lapply(SA9802_colvalue2, function(x) x=0), SA9802_colvalue2)), -from)

chordSA9802_agg <- cbind(SA9802_df2,SA9802_df3)
chordSA9802_agg <- chordSA9802_agg[ ,sort(names(chordSA9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#East Asia & Pacific 9802#
chordEAP9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

EAP9802_colvalue1 <- colnames(select(chordEAP9802_prelim1, -from))

EAP9802_df1 <- cbind(data.frame(from = colnames(select(chordEAP9802_prelim1, -from, -North.Korea))), setNames(lapply(EAP9802_colvalue1, function(x) x=0), EAP9802_colvalue1))

EAP9802_df2 <- rbind(chordEAP9802_prelim1,EAP9802_df1)

chordEAP9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

EAP9802_colvalue2 <- colnames(select(chordEAP9802_prelim2, -to, -`North Korea`))

EAP9802_df3 <- select(cbind(select(EAP9802_df2, from), setNames(lapply(EAP9802_colvalue2, function(x) x=0), EAP9802_colvalue2)), -from)

chordEAP9802_agg <- cbind(EAP9802_df2,EAP9802_df3)
chordEAP9802_agg <- chordEAP9802_agg[ ,sort(names(chordEAP9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Europe & Central Asia 9802#
chordECA9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

ECA9802_colvalue1 <- colnames(select(chordECA9802_prelim1, -from))

ECA9802_df1 <- cbind(data.frame(from = colnames(select(chordECA9802_prelim1, -from, -Russia,-Turkey,-Ukraine))), setNames(lapply(ECA9802_colvalue1, function(x) x=0), ECA9802_colvalue1))

ECA9802_df2 <- rbind(chordECA9802_prelim1,ECA9802_df1)

chordECA9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

ECA9802_colvalue2 <- colnames(select(chordECA9802_prelim2, -to, -Russia,-Turkey,-Ukraine))

ECA9802_df3 <- select(cbind(select(ECA9802_df2, from), setNames(lapply(ECA9802_colvalue2, function(x) x=0), ECA9802_colvalue2)), -from)

chordECA9802_agg <- cbind(ECA9802_df2,ECA9802_df3)
chordECA9802_agg <- chordECA9802_agg[ ,sort(names(chordECA9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Latin America & Caribbean 9802#
chordLAC9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

LAC9802_colvalue1 <- colnames(select(chordLAC9802_prelim1, -from))

LAC9802_df1 <- cbind(data.frame(from = colnames(select(chordLAC9802_prelim1, -from, -Colombia))), setNames(lapply(LAC9802_colvalue1, function(x) x=0), LAC9802_colvalue1))

LAC9802_df2 <- rbind(chordLAC9802_prelim1,LAC9802_df1)

chordLAC9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

LAC9802_colvalue2 <- colnames(select(chordLAC9802_prelim2, -to,-Colombia))

LAC9802_df3 <- select(cbind(select(LAC9802_df2, from), setNames(lapply(LAC9802_colvalue2, function(x) x=0), LAC9802_colvalue2)), -from)

chordLAC9802_agg <- cbind(LAC9802_df2,LAC9802_df3)
chordLAC9802_agg <- chordLAC9802_agg[ ,sort(names(chordLAC9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Middle East & North Africa 9802#
chordMENA9802_prelim1 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

MENA9802_colvalue1 <- colnames(select(chordMENA9802_prelim1, -from))

MENA9802_df1 <- cbind(data.frame(from = colnames(select(chordMENA9802_prelim1, -from, -Israel, -Lebanon, -Libya))), setNames(lapply(MENA9802_colvalue1, function(x) x=0), MENA9802_colvalue1))

MENA9802_df2 <- rbind(chordMENA9802_prelim1,MENA9802_df1)

chordMENA9802_prelim2 <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

MENA9802_colvalue2 <- colnames(select(chordMENA9802_prelim2, -to, -Israel, -Lebanon, -Libya))

MENA9802_df3 <- select(cbind(select(MENA9802_df2, from), setNames(lapply(MENA9802_colvalue2, function(x) x=0), MENA9802_colvalue2)), -from)

chordMENA9802_agg <- cbind(MENA9802_df2,MENA9802_df3)
chordMENA9802_agg <- chordMENA9802_agg[ ,sort(names(chordMENA9802_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#============================================================================#

##2003 TO 2007##
#Sub-Saharan Africa 0307#
chordSSA0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SSA0307_colvalue1 <- colnames(select(chordSSA0307_prelim1, -from))

SSA0307_df1 <- cbind(data.frame(from = colnames(select(chordSSA0307_prelim1, -from, -`South.Africa`))), setNames(lapply(SSA0307_colvalue1, function(x) x=0), SSA0307_colvalue1))

SSA0307_df2 <- rbind(chordSSA0307_prelim1,SSA0307_df1)

chordSSA0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SSA0307_colvalue2 <- colnames(select(chordSSA0307_prelim2, -to, -`South Africa`))

SSA0307_df3 <- select(cbind(select(SSA0307_df2, from), setNames(lapply(SSA0307_colvalue2, function(x) x=0), SSA0307_colvalue2)), -from)

chordSSA0307_agg <- cbind(SSA0307_df2,SSA0307_df3)
chordSSA0307_agg <- chordSSA0307_agg[ ,sort(names(chordSSA0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#South Asia 0307#
chordSA0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SA0307_colvalue1 <- colnames(select(chordSA0307_prelim1, -from))

SA0307_df1 <- cbind(data.frame(from = colnames(select(chordSA0307_prelim1, -from, -India, -Pakistan))), setNames(lapply(SA0307_colvalue1, function(x) x=0), SA0307_colvalue1))

SA0307_df2 <- rbind(chordSA0307_prelim1,SA0307_df1)

chordSA0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SA0307_colvalue2 <- colnames(select(chordSA0307_prelim2, -to, -India, -Pakistan))

SA0307_df3 <- select(cbind(select(SA0307_df2, from), setNames(lapply(SA0307_colvalue2, function(x) x=0), SA0307_colvalue2)), -from)

chordSA0307_agg <- cbind(SA0307_df2,SA0307_df3)
chordSA0307_agg <- chordSA0307_agg[ ,sort(names(chordSA0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#East Asia & Pacific 0307#
chordEAP0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

EAP0307_colvalue1 <- colnames(select(chordEAP0307_prelim1, -from))

EAP0307_df1 <- cbind(data.frame(from = colnames(select(chordEAP0307_prelim1, -from, -North.Korea))), setNames(lapply(EAP0307_colvalue1, function(x) x=0), EAP0307_colvalue1))

EAP0307_df2 <- rbind(chordEAP0307_prelim1,EAP0307_df1)

chordEAP0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

EAP0307_colvalue2 <- colnames(select(chordEAP0307_prelim2, -to, -`North Korea`))

EAP0307_df3 <- select(cbind(select(EAP0307_df2, from), setNames(lapply(EAP0307_colvalue2, function(x) x=0), EAP0307_colvalue2)), -from)

chordEAP0307_agg <- cbind(EAP0307_df2,EAP0307_df3)
chordEAP0307_agg <- chordEAP0307_agg[ ,sort(names(chordEAP0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Europe & Central Asia 0307#
chordECA0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

ECA0307_colvalue1 <- colnames(select(chordECA0307_prelim1, -from))

ECA0307_df1 <- cbind(data.frame(from = colnames(select(chordECA0307_prelim1, -from, -Russia,-Turkey,-Ukraine))), setNames(lapply(ECA0307_colvalue1, function(x) x=0), ECA0307_colvalue1))

ECA0307_df2 <- rbind(chordECA0307_prelim1,ECA0307_df1)

chordECA0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

ECA0307_colvalue2 <- colnames(select(chordECA0307_prelim2, -to, -Russia,-Turkey,-Ukraine))

ECA0307_df3 <- select(cbind(select(ECA0307_df2, from), setNames(lapply(ECA0307_colvalue2, function(x) x=0), ECA0307_colvalue2)), -from)

chordECA0307_agg <- cbind(ECA0307_df2,ECA0307_df3)
chordECA0307_agg <- chordECA0307_agg[ ,sort(names(chordECA0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Latin America & Caribbean 0307#
chordLAC0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

LAC0307_colvalue1 <- colnames(select(chordLAC0307_prelim1, -from))

LAC0307_df1 <- cbind(data.frame(from = colnames(select(chordLAC0307_prelim1, -from))), setNames(lapply(LAC0307_colvalue1, function(x) x=0), LAC0307_colvalue1))

LAC0307_df2 <- rbind(chordLAC0307_prelim1,LAC0307_df1)

chordLAC0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

LAC0307_colvalue2 <- colnames(select(chordLAC0307_prelim2, -to))

LAC0307_df3 <- select(cbind(select(LAC0307_df2, from), setNames(lapply(LAC0307_colvalue2, function(x) x=0), LAC0307_colvalue2)), -from)

chordLAC0307_agg <- cbind(LAC0307_df2,LAC0307_df3)
chordLAC0307_agg <- chordLAC0307_agg[ ,sort(names(chordLAC0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Middle East & North Africa 0307#
chordMENA0307_prelim1 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

MENA0307_colvalue1 <- colnames(select(chordMENA0307_prelim1, -from))

MENA0307_df1 <- cbind(data.frame(from = colnames(select(chordMENA0307_prelim1, -from, -Iran, -Israel, -Libya))), setNames(lapply(MENA0307_colvalue1, function(x) x=0), MENA0307_colvalue1))

MENA0307_df2 <- rbind(chordMENA0307_prelim1,MENA0307_df1)

chordMENA0307_prelim2 <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

MENA0307_colvalue2 <- colnames(select(chordMENA0307_prelim2, -to, -Iran, -Israel, -Libya))

MENA0307_df3 <- select(cbind(select(MENA0307_df2, from), setNames(lapply(MENA0307_colvalue2, function(x) x=0), MENA0307_colvalue2)), -from)

chordMENA0307_agg <- cbind(MENA0307_df2,MENA0307_df3)
chordMENA0307_agg <- chordMENA0307_agg[ ,sort(names(chordMENA0307_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#============================================================================#

##2008 TO 2012##
#Sub-Saharan Africa 0812#
chordSSA0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SSA0812_colvalue1 <- colnames(select(chordSSA0812_prelim1, -from))

SSA0812_df1 <- cbind(data.frame(from = colnames(select(chordSSA0812_prelim1, -from, -`South.Africa`))), setNames(lapply(SSA0812_colvalue1, function(x) x=0), SSA0812_colvalue1))

SSA0812_df2 <- rbind(chordSSA0812_prelim1,SSA0812_df1)

chordSSA0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SSA0812_colvalue2 <- colnames(select(chordSSA0812_prelim2, -to, -`South Africa`))

SSA0812_df3 <- select(cbind(select(SSA0812_df2, from), setNames(lapply(SSA0812_colvalue2, function(x) x=0), SSA0812_colvalue2)), -from)

chordSSA0812_agg <- cbind(SSA0812_df2,SSA0812_df3)
chordSSA0812_agg <- chordSSA0812_agg[ ,sort(names(chordSSA0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#South Asia 0812#
chordSA0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SA0812_colvalue1 <- colnames(select(chordSA0812_prelim1, -from))

SA0812_df1 <- cbind(data.frame(from = colnames(select(chordSA0812_prelim1, -from, -India))), setNames(lapply(SA0812_colvalue1, function(x) x=0), SA0812_colvalue1))

SA0812_df2 <- rbind(chordSA0812_prelim1,SA0812_df1)

chordSA0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SA0812_colvalue2 <- colnames(select(chordSA0812_prelim2, -to, -India))

SA0812_df3 <- select(cbind(select(SA0812_df2, from), setNames(lapply(SA0812_colvalue2, function(x) x=0), SA0812_colvalue2)), -from)

chordSA0812_agg <- cbind(SA0812_df2,SA0812_df3)
chordSA0812_agg <- chordSA0812_agg[ ,sort(names(chordSA0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#East Asia & Pacific 0812#
chordEAP0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

EAP0812_colvalue1 <- colnames(select(chordEAP0812_prelim1, -from))

EAP0812_df1 <- cbind(data.frame(from = colnames(select(chordEAP0812_prelim1, -from, -North.Korea))), setNames(lapply(EAP0812_colvalue1, function(x) x=0), EAP0812_colvalue1))

EAP0812_df2 <- rbind(chordEAP0812_prelim1,EAP0812_df1)

chordEAP0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

EAP0812_colvalue2 <- colnames(select(chordEAP0812_prelim2, -to, -`North Korea`))

EAP0812_df3 <- select(cbind(select(EAP0812_df2, from), setNames(lapply(EAP0812_colvalue2, function(x) x=0), EAP0812_colvalue2)), -from)

chordEAP0812_agg <- cbind(EAP0812_df2,EAP0812_df3)
chordEAP0812_agg <- chordEAP0812_agg[ ,sort(names(chordEAP0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Europe & Central Asia 0812#
chordECA0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

ECA0812_colvalue1 <- colnames(select(chordECA0812_prelim1, -from))

ECA0812_df1 <- cbind(data.frame(from = colnames(select(chordECA0812_prelim1, -from, -Russia,-Turkey,-Ukraine))), setNames(lapply(ECA0812_colvalue1, function(x) x=0), ECA0812_colvalue1))

ECA0812_df2 <- rbind(chordECA0812_prelim1,ECA0812_df1)

chordECA0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

ECA0812_colvalue2 <- colnames(select(chordECA0812_prelim2, -to, -Russia,-Turkey,-Ukraine))

ECA0812_df3 <- select(cbind(select(ECA0812_df2, from), setNames(lapply(ECA0812_colvalue2, function(x) x=0), ECA0812_colvalue2)), -from)

chordECA0812_agg <- cbind(ECA0812_df2,ECA0812_df3)
chordECA0812_agg <- chordECA0812_agg[ ,sort(names(chordECA0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Latin America & Caribbean 0812#
chordLAC0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

LAC0812_colvalue1 <- colnames(select(chordLAC0812_prelim1, -from))

LAC0812_df1 <- cbind(data.frame(from = colnames(select(chordLAC0812_prelim1, -from))), setNames(lapply(LAC0812_colvalue1, function(x) x=0), LAC0812_colvalue1))

LAC0812_df2 <- rbind(chordLAC0812_prelim1,LAC0812_df1)

chordLAC0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

LAC0812_colvalue2 <- colnames(select(chordLAC0812_prelim2, -to))

LAC0812_df3 <- select(cbind(select(LAC0812_df2, from), setNames(lapply(LAC0812_colvalue2, function(x) x=0), LAC0812_colvalue2)), -from)

chordLAC0812_agg <- cbind(LAC0812_df2,LAC0812_df3)
chordLAC0812_agg <- chordLAC0812_agg[ ,sort(names(chordLAC0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Middle East & North Africa 0812#
chordMENA0812_prelim1 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

MENA0812_colvalue1 <- colnames(select(chordMENA0812_prelim1, -from))

MENA0812_df1 <- cbind(data.frame(from = colnames(select(chordMENA0812_prelim1, -from, -Iran, -Israel, -Libya, -Saudi.Arabia))), setNames(lapply(MENA0812_colvalue1, function(x) x=0), MENA0812_colvalue1))

MENA0812_df2 <- rbind(chordMENA0812_prelim1,MENA0812_df1)

chordMENA0812_prelim2 <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

MENA0812_colvalue2 <- colnames(select(chordMENA0812_prelim2, -to, -Iran, -Israel, -Libya, -`Saudi Arabia`))

MENA0812_df3 <- select(cbind(select(MENA0812_df2, from), setNames(lapply(MENA0812_colvalue2, function(x) x=0), MENA0812_colvalue2)), -from)

chordMENA0812_agg <- cbind(MENA0812_df2,MENA0812_df3)
chordMENA0812_agg <- chordMENA0812_agg[ ,sort(names(chordMENA0812_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#============================================================================#

##2013 TO 2017##
#Sub-Saharan Africa 1317#
chordSSA1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SSA1317_colvalue1 <- colnames(select(chordSSA1317_prelim1, -from))

SSA1317_df1 <- cbind(data.frame(from = colnames(select(chordSSA1317_prelim1, -from, -`South.Africa`, -Sudan))), setNames(lapply(SSA1317_colvalue1, function(x) x=0), SSA1317_colvalue1))

SSA1317_df2 <- rbind(chordSSA1317_prelim1,SSA1317_df1)

chordSSA1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SSA1317_colvalue2 <- colnames(select(chordSSA1317_prelim2, -to, -`South Africa`,-Sudan))

SSA1317_df3 <- select(cbind(select(SSA1317_df2, from), setNames(lapply(SSA1317_colvalue2, function(x) x=0), SSA1317_colvalue2)), -from)

chordSSA1317_agg <- cbind(SSA1317_df2,SSA1317_df3)
chordSSA1317_agg <- chordSSA1317_agg[ ,sort(names(chordSSA1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#South Asia 1317#
chordSA1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

SA1317_colvalue1 <- colnames(select(chordSA1317_prelim1, -from))

SA1317_df1 <- cbind(data.frame(from = colnames(select(chordSA1317_prelim1, -from, -India, -Pakistan))), setNames(lapply(SA1317_colvalue1, function(x) x=0), SA1317_colvalue1))

SA1317_df2 <- rbind(chordSA1317_prelim1,SA1317_df1)

chordSA1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

SA1317_colvalue2 <- colnames(select(chordSA1317_prelim2, -to, -India, -Pakistan))

SA1317_df3 <- select(cbind(select(SA1317_df2, from), setNames(lapply(SA1317_colvalue2, function(x) x=0), SA1317_colvalue2)), -from)

chordSA1317_agg <- cbind(SA1317_df2,SA1317_df3)
chordSA1317_agg <- chordSA1317_agg[ ,sort(names(chordSA1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#East Asia & Pacific 1317#
chordEAP1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

EAP1317_colvalue1 <- colnames(select(chordEAP1317_prelim1, -from))

EAP1317_df1 <- cbind(data.frame(from = colnames(select(chordEAP1317_prelim1, -from))), setNames(lapply(EAP1317_colvalue1, function(x) x=0), EAP1317_colvalue1))

EAP1317_df2 <- rbind(chordEAP1317_prelim1,EAP1317_df1)

chordEAP1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

EAP1317_colvalue2 <- colnames(select(chordEAP1317_prelim2, -to))

EAP1317_df3 <- select(cbind(select(EAP1317_df2, from), setNames(lapply(EAP1317_colvalue2, function(x) x=0), EAP1317_colvalue2)), -from)

chordEAP1317_agg <- cbind(EAP1317_df2,EAP1317_df3)
chordEAP1317_agg <- chordEAP1317_agg[ ,sort(names(chordEAP1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Europe & Central Asia 1317#
chordECA1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

ECA1317_colvalue1 <- colnames(select(chordECA1317_prelim1, -from))

ECA1317_df1 <- cbind(data.frame(from = colnames(select(chordECA1317_prelim1, -from, -Russia,-Turkey,-Ukraine))), setNames(lapply(ECA1317_colvalue1, function(x) x=0), ECA1317_colvalue1))

ECA1317_df2 <- rbind(chordECA1317_prelim1,ECA1317_df1)

chordECA1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

ECA1317_colvalue2 <- colnames(select(chordECA1317_prelim2, -to, -Russia,-Turkey,-Ukraine))

ECA1317_df3 <- select(cbind(select(ECA1317_df2, from), setNames(lapply(ECA1317_colvalue2, function(x) x=0), ECA1317_colvalue2)), -from)

chordECA1317_agg <- cbind(ECA1317_df2,ECA1317_df3)
chordECA1317_agg <- chordECA1317_agg[ ,sort(names(chordECA1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Latin America & Caribbean 1317#
chordLAC1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

LAC1317_colvalue1 <- colnames(select(chordLAC1317_prelim1, -from))

LAC1317_df1 <- cbind(data.frame(from = colnames(select(chordLAC1317_prelim1, -from))), setNames(lapply(LAC1317_colvalue1, function(x) x=0), LAC1317_colvalue1))

LAC1317_df2 <- rbind(chordLAC1317_prelim1,LAC1317_df1)

chordLAC1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

LAC1317_colvalue2 <- colnames(select(chordLAC1317_prelim2, -to))

LAC1317_df3 <- select(cbind(select(LAC1317_df2, from), setNames(lapply(LAC1317_colvalue2, function(x) x=0), LAC1317_colvalue2)), -from)

chordLAC1317_agg <- cbind(LAC1317_df2,LAC1317_df3)
chordLAC1317_agg <- chordLAC1317_agg[ ,sort(names(chordLAC1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()


#Middle East & North Africa 1317#
chordMENA1317_prelim1 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("to", "weight")

MENA1317_colvalue1 <- colnames(select(chordMENA1317_prelim1, -from))

MENA1317_df1 <- cbind(data.frame(from = colnames(select(chordMENA1317_prelim1, -from, -Iran, -Israel))), setNames(lapply(MENA1317_colvalue1, function(x) x=0), MENA1317_colvalue1))

MENA1317_df2 <- rbind(chordMENA1317_prelim1,MENA1317_df1)

chordMENA1317_prelim2 <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(to = destCountries) %>%
  rename(weight = flow) %>%
  spread("from", "weight")

MENA1317_colvalue2 <- colnames(select(chordMENA1317_prelim2, -to, -Iran, -Israel))

MENA1317_df3 <- select(cbind(select(MENA1317_df2, from), setNames(lapply(MENA1317_colvalue2, function(x) x=0), MENA1317_colvalue2)), -from)

chordMENA1317_agg <- cbind(MENA1317_df2,MENA1317_df3)
chordMENA1317_agg <- chordMENA1317_agg[ ,sort(names(chordMENA1317_agg))] %>%
  arrange(from) %>%
  select(-from) %>%
  as.matrix()

```


```{r, include=FALSE}
#Loading data for Treemap
tradeFlows <- read_csv("data/countries_Regions_Flows.csv")

#Data Manipulation for Treemap
tradeFlows_grouped <- group_by(tradeFlows, `Years`,
                               `origRegion`, `origCountries`, 
                               `destRegion`, `destCountries`)
tradeFlows_summarised <- summarise(tradeFlows_grouped, 
                          `Total Flows` = sum(`flow`, na.rm = TRUE))

```


```{r, include=FALSE}
#Loading data for ggridges
import1 <- read.csv("data/import1.csv",header=TRUE)
```


```{r, include=FALSE}
#Data Manipulation for Bubble Plot#

pop <- read.csv("data/World Population Data_Taken from worldbank.csv",skip=4,header=TRUE)
population=pop[,c(1,38:62)]
colnames(population) <- gsub("^X", "",  colnames(population))
population1= filter(population, Country.Name %in% c("Zimbabwe","South Africa","Yemen, Rep.","Venezuela, RB","Ukraine","Turkey","Chad","Syrian Arab Republic","South Sudan","Somalia","Sudan","Saudi Arabia","Russian Federation","North Korea","Philippines","Pakistan","Nigeria","Niger","Mauritania","Myanmar","Mali","Mexico","Libya","Lebanon","Kenya","Israel","Iraq","Iran, Islamic Rep.","India","Ethiopia","Eritrea","Egypt, Arab Rep.","Colombia","Congo, Rep.","Congo, Dem. Rep.","Cameroon","Central African Republic","Bahrain","Burundi","Azerbaijan","Afghanistan"))

poplong <- population1 %>% gather(year, value,-Country.Name)

#Change FDI Net Inflow data into long format
fdi <- read.csv("data/FDI Net Inflows.csv",skip=4,header=TRUE)
fdi = fdi [,c(1,38:62)]
colnames(fdi) <- gsub("^X", "",  colnames(fdi))
fdi1= filter(fdi, Country.Name %in% c("Zimbabwe","South Africa","Yemen, Rep.","Venezuela, RB","Ukraine","Turkey","Chad","Syrian Arab Republic","South Sudan","Somalia","Sudan","Saudi Arabia","Russian Federation","North Korea","Philippines","Pakistan","Nigeria","Niger","Mauritania","Myanmar","Mali","Mexico","Libya","Lebanon","Kenya","Israel","Iraq","Iran, Islamic Rep.","India","Ethiopia","Eritrea","Egypt, Arab Rep.","Colombia","Congo, Rep.","Congo, Dem. Rep.","Cameroon","Central African Republic","Bahrain","Burundi","Azerbaijan","Afghanistan"))

fdilong <- fdi1 %>% gather(year, value,-Country.Name)

#Change GDP Per Capita data into long format
gdp <- read.csv("data/GDP per capita.csv",skip=4,header=TRUE)
gdp = gdp [,c(1,38:62)]
colnames(gdp) <- gsub("^X", "",  colnames(gdp))
gdp1= filter(gdp, Country.Name %in% c("Zimbabwe","South Africa","Yemen, Rep.","Venezuela, RB","Ukraine","Turkey","Chad","Syrian Arab Republic","South Sudan","Somalia","Sudan","Saudi Arabia","Russian Federation","North Korea","Philippines","Pakistan","Nigeria","Niger","Mauritania","Myanmar","Mali","Mexico","Libya","Lebanon","Kenya","Israel","Iraq","Iran, Islamic Rep.","India","Ethiopia","Eritrea","Egypt, Arab Rep.","Colombia","Congo, Rep.","Congo, Dem. Rep.","Cameroon","Central African Republic","Bahrain","Burundi","Azerbaijan","Afghanistan"))

gdplong <- gdp1 %>% gather(year, value,-Country.Name)

#Change Pop,FDI & GDP data into single data frame, World Indicators
a <- merge(poplong,fdilong,by=c("Country.Name","year"))
worldindicators <- merge(a,gdplong,by=c("Country.Name","year"))

# Change worldindicatorsdata country names
worldindicators$Country.Name <- recode(worldindicators$Country.Name, `Congo, Dem. Rep.`="Democratic Republic of the Congo",`Congo, Rep.`="Republic of Congo",`Iran, Islamic Rep.`="Iran",`Venezuela, RB`="Venezuela",`Yemen, Rep.`="Yemen",`Egypt, Arab Rep.`="Egypt",`Russian Federation`="Russia",`Syrian Arab Republic`="Syria")
names(worldindicators) <- c("Country","Year","Total Population","FDI Net Inflow","GDP Per Capita")

# Change unit measurement of Population and FDI in terms of 100,000s
worldindicators <- mutate(worldindicators, `Total Population(100000s)` = `Total Population`/100000,`FDI Net Inflow(100000s)` = `FDI Net Inflow`/100000)


#Arms Imports data
import <- read.csv("data/import.csv",header=TRUE)

#Join world indicators and Arms Imports data into combined data
combined <- merge(x = import, y = worldindicators, by = c("Country","Year"), all.x = TRUE)


#Delete rows 676 to 700 as this belong to Palestine and no GDP,FDI and Population is available for Palestine
combined1 <- combined[-c(676:700), ]

```


```{r, include=FALSE}
#For Network 
##1993 TO 2017##

tradeFlows <- read_csv("data/countries_Regions_Flows.csv")

tradeFlows_grouped <- group_by(tradeFlows, `Years`,
                               `origRegion`, `origCountries`, 
                               `destRegion`, `destCountries`)
tradeFlows_summarised <- summarise(tradeFlows_grouped, 
                          `Total Flows` = sum(`flow`, na.rm = TRUE))

all9317 <- ungroup(tradeFlows_summarised) %>%
  select(`origRegion`, `origCountries`, `destRegion`, `destCountries`, `Total Flows`) %>%
  group_by(`origRegion`, `origCountries`, `destRegion`, `destCountries`) %>%
  summarise(`flow` = sum(`Total Flows`, na.rm = TRUE)) %>%
  ungroup()

#Sub-Saharan Africa 9317#
#Creating Link File#
netSSA9317_link <- all9317 %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA9317_link[netSSA9317_link==0] <- NA

netSSA9317_link <- netSSA9317_link[complete.cases(netSSA9317_link),]

netSSA9317_link$to <- gsub("\\.", " ", netSSA9317_link$dest)

netSSA9317_link <- select(netSSA9317_link, -dest)


#Creating Node File
netSSA9317_node_df <- all9317 %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA9317_node_df[netSSA9317_node_df==0] <- NA

netSSA9317_node_df <- netSSA9317_node_df[complete.cases(netSSA9317_node_df),]

netSSA9317_node_dest <- select(netSSA9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA9317_node_dest$id <- gsub("\\.", " ", netSSA9317_node_dest$country)

netSSA9317_node_dest <- select(netSSA9317_node_dest, -country)


netSSA9317_node_orig <-select(netSSA9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA9317_node_agg <- rbind(netSSA9317_node_orig, netSSA9317_node_dest) %>%
  distinct()

#South Asia 9317#
#Creating Link File#
netSA9317_link <- all9317 %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA9317_link[netSA9317_link==0] <- NA

netSA9317_link <- netSA9317_link[complete.cases(netSA9317_link),]

netSA9317_link$to <- gsub("\\.", " ", netSA9317_link$dest)

netSA9317_link <- select(netSA9317_link, -dest)

#Creating Node File
netSA9317_node_df <- all9317 %>% 
  filter(destRegion == "South Asia")

netSA9317_node_df[netSA9317_node_df==0] <- NA

netSA9317_node_df <- netSA9317_node_df[complete.cases(netSA9317_node_df),]

netSA9317_node_dest <- select(netSA9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA9317_node_dest$id <- gsub("\\.", " ", netSA9317_node_dest$country)

netSA9317_node_dest <- select(netSA9317_node_dest, -country)


netSA9317_node_orig <-select(netSA9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA9317_node_agg <- rbind(netSA9317_node_orig, netSA9317_node_dest) %>%
  distinct()

#East Asia & Pacific 9317#
#Creating Link File#
netEAP9317_link <- all9317 %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP9317_link[netEAP9317_link==0] <- NA

netEAP9317_link <- netEAP9317_link[complete.cases(netEAP9317_link),]

netEAP9317_link$to <- gsub("\\.", " ", netEAP9317_link$dest)

netEAP9317_link <- select(netEAP9317_link, -dest)

#Creating Node File
netEAP9317_node_df <- all9317 %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP9317_node_df[netEAP9317_node_df==0] <- NA

netEAP9317_node_df <- netEAP9317_node_df[complete.cases(netEAP9317_node_df),]

netEAP9317_node_dest <- select(netEAP9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP9317_node_dest$id <- gsub("\\.", " ", netEAP9317_node_dest$country)

netEAP9317_node_dest <- select(netEAP9317_node_dest, -country)


netEAP9317_node_orig <-select(netEAP9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP9317_node_agg <- rbind(netEAP9317_node_orig, netEAP9317_node_dest) %>%
  distinct()


#Europe & Central Asia 9317#
#Creating Link File#
netECA9317_link <- all9317 %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA9317_link[netECA9317_link==0] <- NA

netECA9317_link <- netECA9317_link[complete.cases(netECA9317_link),]

netECA9317_link$to <- gsub("\\.", " ", netECA9317_link$dest)

netECA9317_link <- select(netECA9317_link, -dest)

#Creating Node File
netECA9317_node_df <- all9317 %>% 
  filter(destRegion == "Europe & Central Asia")

netECA9317_node_df[netECA9317_node_df==0] <- NA

netECA9317_node_df <- netECA9317_node_df[complete.cases(netECA9317_node_df),]

netECA9317_node_dest <- select(netECA9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA9317_node_dest$id <- gsub("\\.", " ", netECA9317_node_dest$country)

netECA9317_node_dest <- select(netECA9317_node_dest, -country)


netECA9317_node_orig <-select(netECA9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA9317_node_agg <- rbind(netECA9317_node_orig, netECA9317_node_dest) %>%
  distinct()


#Latin America & Caribbean 9317#
#Creating Link File#
netLAC9317_link <- all9317 %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC9317_link[netLAC9317_link==0] <- NA

netLAC9317_link <- netLAC9317_link[complete.cases(netLAC9317_link),]

netLAC9317_link$to <- gsub("\\.", " ", netLAC9317_link$dest)

netLAC9317_link <- select(netLAC9317_link, -dest)

#Creating Node File
netLAC9317_node_df <- all9317 %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC9317_node_df[netLAC9317_node_df==0] <- NA

netLAC9317_node_df <- netLAC9317_node_df[complete.cases(netLAC9317_node_df),]

netLAC9317_node_dest <- select(netLAC9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC9317_node_dest$id <- gsub("\\.", " ", netLAC9317_node_dest$country)

netLAC9317_node_dest <- select(netLAC9317_node_dest, -country)


netLAC9317_node_orig <-select(netLAC9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC9317_node_agg <- rbind(netLAC9317_node_orig, netLAC9317_node_dest) %>%
  distinct()


#Middle East & North Africa 9317#
#Creating Link File#
netMENA9317_link <- all9317 %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA9317_link[netMENA9317_link==0] <- NA

netMENA9317_link <- netMENA9317_link[complete.cases(netMENA9317_link),]

netMENA9317_link$to <- gsub("\\.", " ", netMENA9317_link$dest)

netMENA9317_link <- select(netMENA9317_link, -dest)

#Creating Node File
netMENA9317_node_df <- all9317 %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA9317_node_df[netMENA9317_node_df==0] <- NA

netMENA9317_node_df <- netMENA9317_node_df[complete.cases(netMENA9317_node_df),]

netMENA9317_node_dest <- select(netMENA9317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA9317_node_dest$id <- gsub("\\.", " ", netMENA9317_node_dest$country)

netMENA9317_node_dest <- select(netMENA9317_node_dest, -country)


netMENA9317_node_orig <-select(netMENA9317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA9317_node_agg <- rbind(netMENA9317_node_orig, netMENA9317_node_dest) %>%
  distinct()


#============================================================================#

##1993 TO 1997##
#Sub-Saharan Africa 9397#

#Creating Link File#
netSSA9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA9397_link[netSSA9397_link==0] <- NA

netSSA9397_link <- netSSA9397_link[complete.cases(netSSA9397_link),]

netSSA9397_link$to <- gsub("\\.", " ", netSSA9397_link$dest)

netSSA9397_link <- select(netSSA9397_link, -dest)

#Creating Node File
netSSA9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA9397_node_df[netSSA9397_node_df==0] <- NA

netSSA9397_node_df <- netSSA9397_node_df[complete.cases(netSSA9397_node_df),]

netSSA9397_node_dest <- select(netSSA9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA9397_node_dest$id <- gsub("\\.", " ", netSSA9397_node_dest$country)

netSSA9397_node_dest <- select(netSSA9397_node_dest, -country)


netSSA9397_node_orig <-select(netSSA9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA9397_node_agg <- rbind(netSSA9397_node_orig, netSSA9397_node_dest) %>%
  distinct()

##1993 TO 1997##
#South Asia 9397#

#Creating Link File#
netSA9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA9397_link[netSA9397_link==0] <- NA

netSA9397_link <- netSA9397_link[complete.cases(netSA9397_link),]

netSA9397_link$to <- gsub("\\.", " ", netSA9397_link$dest)

netSA9397_link <- select(netSA9397_link, -dest)

#Creating Node File
netSA9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "South Asia")

netSA9397_node_df[netSA9397_node_df==0] <- NA

netSA9397_node_df <- netSA9397_node_df[complete.cases(netSA9397_node_df),]

netSA9397_node_dest <- select(netSA9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA9397_node_dest$id <- gsub("\\.", " ", netSA9397_node_dest$country)

netSA9397_node_dest <- select(netSA9397_node_dest, -country)


netSA9397_node_orig <-select(netSA9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA9397_node_agg <- rbind(netSA9397_node_orig, netSA9397_node_dest) %>%
  distinct()

#============================================================================#

#East Asia & Pacific 9397#

#Creating Link File#
netEAP9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP9397_link[netEAP9397_link==0] <- NA

netEAP9397_link <- netEAP9397_link[complete.cases(netEAP9397_link),]

netEAP9397_link$to <- gsub("\\.", " ", netEAP9397_link$dest)

netEAP9397_link <- select(netEAP9397_link, -dest)

#Creating Node File
netEAP9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP9397_node_df[netEAP9397_node_df==0] <- NA

netEAP9397_node_df <- netEAP9397_node_df[complete.cases(netEAP9397_node_df),]

netEAP9397_node_dest <- select(netEAP9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP9397_node_dest$id <- gsub("\\.", " ", netEAP9397_node_dest$country)

netEAP9397_node_dest <- select(netEAP9397_node_dest, -country)


netEAP9397_node_orig <-select(netEAP9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP9397_node_agg <- rbind(netEAP9397_node_orig, netEAP9397_node_dest) %>%
  distinct()

#============================================================================#

#Europe & Central Asia 9397#

#Creating Link File#
netECA9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA9397_link[netECA9397_link==0] <- NA

netECA9397_link <- netECA9397_link[complete.cases(netECA9397_link),]

netECA9397_link$to <- gsub("\\.", " ", netECA9397_link$dest)

netECA9397_link <- select(netECA9397_link, -dest)

#Creating Node File
netECA9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia")

netECA9397_node_df[netECA9397_node_df==0] <- NA

netECA9397_node_df <- netECA9397_node_df[complete.cases(netECA9397_node_df),]

netECA9397_node_dest <- select(netECA9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA9397_node_dest$id <- gsub("\\.", " ", netECA9397_node_dest$country)

netECA9397_node_dest <- select(netECA9397_node_dest, -country)


netECA9397_node_orig <-select(netECA9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA9397_node_agg <- rbind(netECA9397_node_orig, netECA9397_node_dest) %>%
  distinct()

#============================================================================#

#Latin America & Caribbean 9397#

#Creating Link File#
netLAC9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC9397_link[netLAC9397_link==0] <- NA

netLAC9397_link <- netLAC9397_link[complete.cases(netLAC9397_link),]

netLAC9397_link$to <- gsub("\\.", " ", netLAC9397_link$dest)

netLAC9397_link <- select(netLAC9397_link, -dest)

#Creating Node File
netLAC9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC9397_node_df[netLAC9397_node_df==0] <- NA

netLAC9397_node_df <- netLAC9397_node_df[complete.cases(netLAC9397_node_df),]

netLAC9397_node_dest <- select(netLAC9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC9397_node_dest$id <- gsub("\\.", " ", netLAC9397_node_dest$country)

netLAC9397_node_dest <- select(netLAC9397_node_dest, -country)


netLAC9397_node_orig <-select(netLAC9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC9397_node_agg <- rbind(netLAC9397_node_orig, netLAC9397_node_dest) %>%
  distinct()

#============================================================================#

#Middle East & North Africa 9397#

#Creating Link File#
netMENA9397_link <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA9397_link[netMENA9397_link==0] <- NA

netMENA9397_link <- netMENA9397_link[complete.cases(netMENA9397_link),]

netMENA9397_link$to <- gsub("\\.", " ", netMENA9397_link$dest)

netMENA9397_link <- select(netMENA9397_link, -dest)

#Creating Node File
netMENA9397_node_df <- read_csv("data/countries9397_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA9397_node_df[netMENA9397_node_df==0] <- NA

netMENA9397_node_df <- netMENA9397_node_df[complete.cases(netMENA9397_node_df),]

netMENA9397_node_dest <- select(netMENA9397_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA9397_node_dest$id <- gsub("\\.", " ", netMENA9397_node_dest$country)

netMENA9397_node_dest <- select(netMENA9397_node_dest, -country)


netMENA9397_node_orig <-select(netMENA9397_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA9397_node_agg <- rbind(netMENA9397_node_orig, netMENA9397_node_dest) %>%
  distinct()

#============================================================================#

##1998 TO 2002##
#Sub-Saharan Africa 9802#

#Creating Link File#
netSSA9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA9802_link[netSSA9802_link==0] <- NA

netSSA9802_link <- netSSA9802_link[complete.cases(netSSA9802_link),]

netSSA9802_link$to <- gsub("\\.", " ", netSSA9802_link$dest)

netSSA9802_link <- select(netSSA9802_link, -dest)

#Creating Node File
netSSA9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA9802_node_df[netSSA9802_node_df==0] <- NA

netSSA9802_node_df <- netSSA9802_node_df[complete.cases(netSSA9802_node_df),]

netSSA9802_node_dest <- select(netSSA9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA9802_node_dest$id <- gsub("\\.", " ", netSSA9802_node_dest$country)

netSSA9802_node_dest <- select(netSSA9802_node_dest, -country)


netSSA9802_node_orig <-select(netSSA9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA9802_node_agg <- rbind(netSSA9802_node_orig, netSSA9802_node_dest) %>%
  distinct()

#============================================================================#

#South Asia 9802#

#Creating Link File#
netSA9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA9802_link[netSA9802_link==0] <- NA

netSA9802_link <- netSA9802_link[complete.cases(netSA9802_link),]

netSA9802_link$to <- gsub("\\.", " ", netSA9802_link$dest)

netSA9802_link <- select(netSA9802_link, -dest)

#Creating Node File
netSA9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "South Asia")

netSA9802_node_df[netSA9802_node_df==0] <- NA

netSA9802_node_df <- netSA9802_node_df[complete.cases(netSA9802_node_df),]

netSA9802_node_dest <- select(netSA9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA9802_node_dest$id <- gsub("\\.", " ", netSA9802_node_dest$country)

netSA9802_node_dest <- select(netSA9802_node_dest, -country)


netSA9802_node_orig <-select(netSA9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA9802_node_agg <- rbind(netSA9802_node_orig, netSA9802_node_dest) %>%
  distinct()

#============================================================================#

#East Asia & Pacific 9802#

#Creating Link File#
netEAP9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP9802_link[netEAP9802_link==0] <- NA

netEAP9802_link <- netEAP9802_link[complete.cases(netEAP9802_link),]

netEAP9802_link$to <- gsub("\\.", " ", netEAP9802_link$dest)

netEAP9802_link <- select(netEAP9802_link, -dest)

#Creating Node File
netEAP9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP9802_node_df[netEAP9802_node_df==0] <- NA

netEAP9802_node_df <- netEAP9802_node_df[complete.cases(netEAP9802_node_df),]

netEAP9802_node_dest <- select(netEAP9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP9802_node_dest$id <- gsub("\\.", " ", netEAP9802_node_dest$country)

netEAP9802_node_dest <- select(netEAP9802_node_dest, -country)


netEAP9802_node_orig <-select(netEAP9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP9802_node_agg <- rbind(netEAP9802_node_orig, netEAP9802_node_dest) %>%
  distinct()

#============================================================================#

#Europe & Central Asia 9802#

#Creating Link File#
netECA9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA9802_link[netECA9802_link==0] <- NA

netECA9802_link <- netECA9802_link[complete.cases(netECA9802_link),]

netECA9802_link$to <- gsub("\\.", " ", netECA9802_link$dest)

netECA9802_link <- select(netECA9802_link, -dest)

#Creating Node File
netECA9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia")

netECA9802_node_df[netECA9802_node_df==0] <- NA

netECA9802_node_df <- netECA9802_node_df[complete.cases(netECA9802_node_df),]

netECA9802_node_dest <- select(netECA9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA9802_node_dest$id <- gsub("\\.", " ", netECA9802_node_dest$country)

netECA9802_node_dest <- select(netECA9802_node_dest, -country)


netECA9802_node_orig <-select(netECA9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA9802_node_agg <- rbind(netECA9802_node_orig, netECA9802_node_dest) %>%
  distinct()

#============================================================================#

#Latin America & Caribbean 9802#

#Creating Link File#
netLAC9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC9802_link[netLAC9802_link==0] <- NA

netLAC9802_link <- netLAC9802_link[complete.cases(netLAC9802_link),]

netLAC9802_link$to <- gsub("\\.", " ", netLAC9802_link$dest)

netLAC9802_link <- select(netLAC9802_link, -dest)

#Creating Node File
netLAC9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC9802_node_df[netLAC9802_node_df==0] <- NA

netLAC9802_node_df <- netLAC9802_node_df[complete.cases(netLAC9802_node_df),]

netLAC9802_node_dest <- select(netLAC9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC9802_node_dest$id <- gsub("\\.", " ", netLAC9802_node_dest$country)

netLAC9802_node_dest <- select(netLAC9802_node_dest, -country)


netLAC9802_node_orig <-select(netLAC9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC9802_node_agg <- rbind(netLAC9802_node_orig, netLAC9802_node_dest) %>%
  distinct()

#============================================================================#

#Middle East & North Africa 9802#

#Creating Link File#
netMENA9802_link <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA9802_link[netMENA9802_link==0] <- NA

netMENA9802_link <- netMENA9802_link[complete.cases(netMENA9802_link),]

netMENA9802_link$to <- gsub("\\.", " ", netMENA9802_link$dest)

netMENA9802_link <- select(netMENA9802_link, -dest)

#Creating Node File
netMENA9802_node_df <- read_csv("data/countries9802_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA9802_node_df[netMENA9802_node_df==0] <- NA

netMENA9802_node_df <- netMENA9802_node_df[complete.cases(netMENA9802_node_df),]

netMENA9802_node_dest <- select(netMENA9802_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA9802_node_dest$id <- gsub("\\.", " ", netMENA9802_node_dest$country)

netMENA9802_node_dest <- select(netMENA9802_node_dest, -country)


netMENA9802_node_orig <-select(netMENA9802_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA9802_node_agg <- rbind(netMENA9802_node_orig, netMENA9802_node_dest) %>%
  distinct()

#============================================================================#

##2003 TO 2007##
#Sub-Saharan Africa 0307#

#Creating Link File#
netSSA0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA0307_link[netSSA0307_link==0] <- NA

netSSA0307_link <- netSSA0307_link[complete.cases(netSSA0307_link),]

netSSA0307_link$to <- gsub("\\.", " ", netSSA0307_link$dest)

netSSA0307_link <- select(netSSA0307_link, -dest)

#Creating Node File
netSSA0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA0307_node_df[netSSA0307_node_df==0] <- NA

netSSA0307_node_df <- netSSA0307_node_df[complete.cases(netSSA0307_node_df),]

netSSA0307_node_dest <- select(netSSA0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA0307_node_dest$id <- gsub("\\.", " ", netSSA0307_node_dest$country)

netSSA0307_node_dest <- select(netSSA0307_node_dest, -country)


netSSA0307_node_orig <-select(netSSA0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA0307_node_agg <- rbind(netSSA0307_node_orig, netSSA0307_node_dest) %>%
  distinct()

#============================================================================#

#South Asia 0307#

#Creating Link File#
netSA0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA0307_link[netSA0307_link==0] <- NA

netSA0307_link <- netSA0307_link[complete.cases(netSA0307_link),]

netSA0307_link$to <- gsub("\\.", " ", netSA0307_link$dest)

netSA0307_link <- select(netSA0307_link, -dest)

#Creating Node File
netSA0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "South Asia")

netSA0307_node_df[netSA0307_node_df==0] <- NA

netSA0307_node_df <- netSA0307_node_df[complete.cases(netSA0307_node_df),]

netSA0307_node_dest <- select(netSA0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA0307_node_dest$id <- gsub("\\.", " ", netSA0307_node_dest$country)

netSA0307_node_dest <- select(netSA0307_node_dest, -country)


netSA0307_node_orig <-select(netSA0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA0307_node_agg <- rbind(netSA0307_node_orig, netSA0307_node_dest) %>%
  distinct()

#============================================================================#

#East Asia & Pacific 0307#

#Creating Link File#
netEAP0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP0307_link[netEAP0307_link==0] <- NA

netEAP0307_link <- netEAP0307_link[complete.cases(netEAP0307_link),]

netEAP0307_link$to <- gsub("\\.", " ", netEAP0307_link$dest)

netEAP0307_link <- select(netEAP0307_link, -dest)

#Creating Node File
netEAP0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP0307_node_df[netEAP0307_node_df==0] <- NA

netEAP0307_node_df <- netEAP0307_node_df[complete.cases(netEAP0307_node_df),]

netEAP0307_node_dest <- select(netEAP0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP0307_node_dest$id <- gsub("\\.", " ", netEAP0307_node_dest$country)

netEAP0307_node_dest <- select(netEAP0307_node_dest, -country)


netEAP0307_node_orig <-select(netEAP0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP0307_node_agg <- rbind(netEAP0307_node_orig, netEAP0307_node_dest) %>%
  distinct()

#============================================================================#

#Europe & Central Asia 0307#

#Creating Link File#
netECA0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA0307_link[netECA0307_link==0] <- NA

netECA0307_link <- netECA0307_link[complete.cases(netECA0307_link),]

netECA0307_link$to <- gsub("\\.", " ", netECA0307_link$dest)

netECA0307_link <- select(netECA0307_link, -dest)

#Creating Node File
netECA0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia")

netECA0307_node_df[netECA0307_node_df==0] <- NA

netECA0307_node_df <- netECA0307_node_df[complete.cases(netECA0307_node_df),]

netECA0307_node_dest <- select(netECA0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA0307_node_dest$id <- gsub("\\.", " ", netECA0307_node_dest$country)

netECA0307_node_dest <- select(netECA0307_node_dest, -country)


netECA0307_node_orig <-select(netECA0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA0307_node_agg <- rbind(netECA0307_node_orig, netECA0307_node_dest) %>%
  distinct()

#============================================================================#

#Latin America & Caribbean 0307#

#Creating Link File#
netLAC0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC0307_link[netLAC0307_link==0] <- NA

netLAC0307_link <- netLAC0307_link[complete.cases(netLAC0307_link),]

netLAC0307_link$to <- gsub("\\.", " ", netLAC0307_link$dest)

netLAC0307_link <- select(netLAC0307_link, -dest)

#Creating Node File
netLAC0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC0307_node_df[netLAC0307_node_df==0] <- NA

netLAC0307_node_df <- netLAC0307_node_df[complete.cases(netLAC0307_node_df),]

netLAC0307_node_dest <- select(netLAC0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC0307_node_dest$id <- gsub("\\.", " ", netLAC0307_node_dest$country)

netLAC0307_node_dest <- select(netLAC0307_node_dest, -country)


netLAC0307_node_orig <-select(netLAC0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC0307_node_agg <- rbind(netLAC0307_node_orig, netLAC0307_node_dest) %>%
  distinct()

#============================================================================#

#Middle East & North Africa 0307#

#Creating Link File#
netMENA0307_link <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA0307_link[netMENA0307_link==0] <- NA

netMENA0307_link <- netMENA0307_link[complete.cases(netMENA0307_link),]

netMENA0307_link$to <- gsub("\\.", " ", netMENA0307_link$dest)

netMENA0307_link <- select(netMENA0307_link, -dest)

#Creating Node File
netMENA0307_node_df <- read_csv("data/countries0307_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA0307_node_df[netMENA0307_node_df==0] <- NA

netMENA0307_node_df <- netMENA0307_node_df[complete.cases(netMENA0307_node_df),]

netMENA0307_node_dest <- select(netMENA0307_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA0307_node_dest$id <- gsub("\\.", " ", netMENA0307_node_dest$country)

netMENA0307_node_dest <- select(netMENA0307_node_dest, -country)


netMENA0307_node_orig <-select(netMENA0307_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA0307_node_agg <- rbind(netMENA0307_node_orig, netMENA0307_node_dest) %>%
  distinct()

#============================================================================#

##2008 TO 2012##
#Sub-Saharan Africa 0812#

#Creating Link File#
netSSA0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA0812_link[netSSA0812_link==0] <- NA

netSSA0812_link <- netSSA0812_link[complete.cases(netSSA0812_link),]

netSSA0812_link$to <- gsub("\\.", " ", netSSA0812_link$dest)

netSSA0812_link <- select(netSSA0812_link, -dest)

#Creating Node File
netSSA0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA0812_node_df[netSSA0812_node_df==0] <- NA

netSSA0812_node_df <- netSSA0812_node_df[complete.cases(netSSA0812_node_df),]

netSSA0812_node_dest <- select(netSSA0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA0812_node_dest$id <- gsub("\\.", " ", netSSA0812_node_dest$country)

netSSA0812_node_dest <- select(netSSA0812_node_dest, -country)


netSSA0812_node_orig <-select(netSSA0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA0812_node_agg <- rbind(netSSA0812_node_orig, netSSA0812_node_dest) %>%
  distinct()

#============================================================================#

#South Asia 0812#

#Creating Link File#
netSA0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA0812_link[netSA0812_link==0] <- NA

netSA0812_link <- netSA0812_link[complete.cases(netSA0812_link),]

netSA0812_link$to <- gsub("\\.", " ", netSA0812_link$dest)

netSA0812_link <- select(netSA0812_link, -dest)

#Creating Node File
netSA0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "South Asia")

netSA0812_node_df[netSA0812_node_df==0] <- NA

netSA0812_node_df <- netSA0812_node_df[complete.cases(netSA0812_node_df),]

netSA0812_node_dest <- select(netSA0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA0812_node_dest$id <- gsub("\\.", " ", netSA0812_node_dest$country)

netSA0812_node_dest <- select(netSA0812_node_dest, -country)


netSA0812_node_orig <-select(netSA0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA0812_node_agg <- rbind(netSA0812_node_orig, netSA0812_node_dest) %>%
  distinct()

#============================================================================#

#East Asia & Pacific 0812#

#Creating Link File#
netEAP0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP0812_link[netEAP0812_link==0] <- NA

netEAP0812_link <- netEAP0812_link[complete.cases(netEAP0812_link),]

netEAP0812_link$to <- gsub("\\.", " ", netEAP0812_link$dest)

netEAP0812_link <- select(netEAP0812_link, -dest)

#Creating Node File
netEAP0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP0812_node_df[netEAP0812_node_df==0] <- NA

netEAP0812_node_df <- netEAP0812_node_df[complete.cases(netEAP0812_node_df),]

netEAP0812_node_dest <- select(netEAP0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP0812_node_dest$id <- gsub("\\.", " ", netEAP0812_node_dest$country)

netEAP0812_node_dest <- select(netEAP0812_node_dest, -country)


netEAP0812_node_orig <-select(netEAP0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP0812_node_agg <- rbind(netEAP0812_node_orig, netEAP0812_node_dest) %>%
  distinct()

#============================================================================#

#Europe & Central Asia 0812#

#Creating Link File#
netECA0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA0812_link[netECA0812_link==0] <- NA

netECA0812_link <- netECA0812_link[complete.cases(netECA0812_link),]

netECA0812_link$to <- gsub("\\.", " ", netECA0812_link$dest)

netECA0812_link <- select(netECA0812_link, -dest)

#Creating Node File
netECA0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia")

netECA0812_node_df[netECA0812_node_df==0] <- NA

netECA0812_node_df <- netECA0812_node_df[complete.cases(netECA0812_node_df),]

netECA0812_node_dest <- select(netECA0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA0812_node_dest$id <- gsub("\\.", " ", netECA0812_node_dest$country)

netECA0812_node_dest <- select(netECA0812_node_dest, -country)


netECA0812_node_orig <-select(netECA0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA0812_node_agg <- rbind(netECA0812_node_orig, netECA0812_node_dest) %>%
  distinct()

#============================================================================#

#Latin America & Caribbean 0812#

#Creating Link File#
netLAC0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC0812_link[netLAC0812_link==0] <- NA

netLAC0812_link <- netLAC0812_link[complete.cases(netLAC0812_link),]

netLAC0812_link$to <- gsub("\\.", " ", netLAC0812_link$dest)

netLAC0812_link <- select(netLAC0812_link, -dest)

#Creating Node File
netLAC0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC0812_node_df[netLAC0812_node_df==0] <- NA

netLAC0812_node_df <- netLAC0812_node_df[complete.cases(netLAC0812_node_df),]

netLAC0812_node_dest <- select(netLAC0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC0812_node_dest$id <- gsub("\\.", " ", netLAC0812_node_dest$country)

netLAC0812_node_dest <- select(netLAC0812_node_dest, -country)


netLAC0812_node_orig <-select(netLAC0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC0812_node_agg <- rbind(netLAC0812_node_orig, netLAC0812_node_dest) %>%
  distinct()

#============================================================================#

#Middle East & North Africa 0812#

#Creating Link File#
netMENA0812_link <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA0812_link[netMENA0812_link==0] <- NA

netMENA0812_link <- netMENA0812_link[complete.cases(netMENA0812_link),]

netMENA0812_link$to <- gsub("\\.", " ", netMENA0812_link$dest)

netMENA0812_link <- select(netMENA0812_link, -dest)

#Creating Node File
netMENA0812_node_df <- read_csv("data/countries0812_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA0812_node_df[netMENA0812_node_df==0] <- NA

netMENA0812_node_df <- netMENA0812_node_df[complete.cases(netMENA0812_node_df),]

netMENA0812_node_dest <- select(netMENA0812_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA0812_node_dest$id <- gsub("\\.", " ", netMENA0812_node_dest$country)

netMENA0812_node_dest <- select(netMENA0812_node_dest, -country)


netMENA0812_node_orig <-select(netMENA0812_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA0812_node_agg <- rbind(netMENA0812_node_orig, netMENA0812_node_dest) %>%
  distinct()

#============================================================================#

##2013 TO 2017##
#Sub-Saharan Africa 1317#

#Creating Link File#
netSSA1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSSA1317_link[netSSA1317_link==0] <- NA

netSSA1317_link <- netSSA1317_link[complete.cases(netSSA1317_link),]

netSSA1317_link$to <- gsub("\\.", " ", netSSA1317_link$dest)

netSSA1317_link <- select(netSSA1317_link, -dest)

#Creating Node File
netSSA1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Sub-Saharan Africa")

netSSA1317_node_df[netSSA1317_node_df==0] <- NA

netSSA1317_node_df <- netSSA1317_node_df[complete.cases(netSSA1317_node_df),]

netSSA1317_node_dest <- select(netSSA1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSSA1317_node_dest$id <- gsub("\\.", " ", netSSA1317_node_dest$country)

netSSA1317_node_dest <- select(netSSA1317_node_dest, -country)


netSSA1317_node_orig <-select(netSSA1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSSA1317_node_agg <- rbind(netSSA1317_node_orig, netSSA1317_node_dest) %>%
  distinct()

#============================================================================#

#South Asia 1317#

#Creating Link File#
netSA1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "South Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netSA1317_link[netSA1317_link==0] <- NA

netSA1317_link <- netSA1317_link[complete.cases(netSA1317_link),]

netSA1317_link$to <- gsub("\\.", " ", netSA1317_link$dest)

netSA1317_link <- select(netSA1317_link, -dest)

#Creating Node File
netSA1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "South Asia")

netSA1317_node_df[netSA1317_node_df==0] <- NA

netSA1317_node_df <- netSA1317_node_df[complete.cases(netSA1317_node_df),]

netSA1317_node_dest <- select(netSA1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netSA1317_node_dest$id <- gsub("\\.", " ", netSA1317_node_dest$country)

netSA1317_node_dest <- select(netSA1317_node_dest, -country)


netSA1317_node_orig <-select(netSA1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netSA1317_node_agg <- rbind(netSA1317_node_orig, netSA1317_node_dest) %>%
  distinct()

#============================================================================#

#East Asia & Pacific 1317#

#Creating Link File#
netEAP1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netEAP1317_link[netEAP1317_link==0] <- NA

netEAP1317_link <- netEAP1317_link[complete.cases(netEAP1317_link),]

netEAP1317_link$to <- gsub("\\.", " ", netEAP1317_link$dest)

netEAP1317_link <- select(netEAP1317_link, -dest)

#Creating Node File
netEAP1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "East Asia & Pacific")

netEAP1317_node_df[netEAP1317_node_df==0] <- NA

netEAP1317_node_df <- netEAP1317_node_df[complete.cases(netEAP1317_node_df),]

netEAP1317_node_dest <- select(netEAP1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netEAP1317_node_dest$id <- gsub("\\.", " ", netEAP1317_node_dest$country)

netEAP1317_node_dest <- select(netEAP1317_node_dest, -country)


netEAP1317_node_orig <-select(netEAP1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netEAP1317_node_agg <- rbind(netEAP1317_node_orig, netEAP1317_node_dest) %>%
  distinct()

#============================================================================#

#Europe & Central Asia 1317#

#Creating Link File#
netECA1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netECA1317_link[netECA1317_link==0] <- NA

netECA1317_link <- netECA1317_link[complete.cases(netECA1317_link),]

netECA1317_link$to <- gsub("\\.", " ", netECA1317_link$dest)

netECA1317_link <- select(netECA1317_link, -dest)

#Creating Node File
netECA1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Europe & Central Asia")

netECA1317_node_df[netECA1317_node_df==0] <- NA

netECA1317_node_df <- netECA1317_node_df[complete.cases(netECA1317_node_df),]

netECA1317_node_dest <- select(netECA1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netECA1317_node_dest$id <- gsub("\\.", " ", netECA1317_node_dest$country)

netECA1317_node_dest <- select(netECA1317_node_dest, -country)


netECA1317_node_orig <-select(netECA1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netECA1317_node_agg <- rbind(netECA1317_node_orig, netECA1317_node_dest) %>%
  distinct()

#============================================================================#

#Latin America & Caribbean 1317#

#Creating Link File#
netLAC1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netLAC1317_link[netLAC1317_link==0] <- NA

netLAC1317_link <- netLAC1317_link[complete.cases(netLAC1317_link),]

netLAC1317_link$to <- gsub("\\.", " ", netLAC1317_link$dest)

netLAC1317_link <- select(netLAC1317_link, -dest)

#Creating Node File
netLAC1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Latin America & Caribbean")

netLAC1317_node_df[netLAC1317_node_df==0] <- NA

netLAC1317_node_df <- netLAC1317_node_df[complete.cases(netLAC1317_node_df),]

netLAC1317_node_dest <- select(netLAC1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netLAC1317_node_dest$id <- gsub("\\.", " ", netLAC1317_node_dest$country)

netLAC1317_node_dest <- select(netLAC1317_node_dest, -country)


netLAC1317_node_orig <-select(netLAC1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netLAC1317_node_agg <- rbind(netLAC1317_node_orig, netLAC1317_node_dest) %>%
  distinct()

#============================================================================#

#Middle East & North Africa 1317#

#Creating Link File#
netMENA1317_link <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa") %>%
  select(origCountries, destCountries, flow) %>%
  rename(from = origCountries) %>%
  rename(dest = destCountries) %>%
  rename(weight = flow)

netMENA1317_link[netMENA1317_link==0] <- NA

netMENA1317_link <- netMENA1317_link[complete.cases(netMENA1317_link),]

netMENA1317_link$to <- gsub("\\.", " ", netMENA1317_link$dest)

netMENA1317_link <- select(netMENA1317_link, -dest)

#Creating Node File
netMENA1317_node_df <- read_csv("data/countries1317_Regions.csv") %>% 
  filter(destRegion == "Middle East & North Africa")

netMENA1317_node_df[netMENA1317_node_df==0] <- NA

netMENA1317_node_df <- netMENA1317_node_df[complete.cases(netMENA1317_node_df),]

netMENA1317_node_dest <- select(netMENA1317_node_df, destCountries,destRegion) %>%
  distinct() %>%
  rename(country = destCountries) %>%
  rename(group = destRegion)

netMENA1317_node_dest$id <- gsub("\\.", " ", netMENA1317_node_dest$country)

netMENA1317_node_dest <- select(netMENA1317_node_dest, -country)


netMENA1317_node_orig <-select(netMENA1317_node_df, origCountries, origRegion) %>%
  distinct() %>%
  rename(id = origCountries) %>%
  rename(group = origRegion)

netMENA1317_node_agg <- rbind(netMENA1317_node_orig, netMENA1317_node_dest) %>%
  distinct()

```

2018 Global Peace Index
=======================================================================

```{r, echo = FALSE}
clrs <- brewer.pal(15, "YlOrRd")

pal <- colorBin(
  palette = clrs,
  domain = gpimap$Rank,
  15
)

labels <- sprintf(
  "<strong>%s</strong><br/>GPI Rank: %g",
  gpimap$NAME, gpimap$Rank
) %>% lapply(htmltools::HTML)

leaflet(gpimap) %>%
  addTiles() %>%
  addPolygons(stroke = FALSE, 
              smoothFactor = 0.2, 
              fillOpacity = 1, 
              color = ~pal(Rank), 
              highlight = highlightOptions(
                weight = 5,
                color = "#666",
                fillOpacity = 0.7,
                bringToFront = TRUE),
              label = labels,
              labelOptions = labelOptions(
                style = list("font-weight" = "normal", padding = "3px 8px"),
                textsize = "15px",
                direction = "auto")) %>%
  addLegend("bottomright", pal = pal, values = ~Rank, title = "GPI Rank", opacity = 1)  %>%
  setView(
    lng = 12.77, lat = 35.34,
    zoom = 2)


```

Top 100 Importers from 1993 to 2017
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Sidebar

```{r, echo = FALSE}
selectInput('select_top100region',"Select Region",
               choices = c("Sub-Saharan Africa", "South Asia", "East Asia & Pacific", "Europe & Central Asia", "Latin America & Caribbean", "Middle East & North Africa", "North America"),
            selected = "Sub-Saharan Africa")

selectInput('select_mapyear',"Select Year",
               choices = c("1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017"),
            selected = "1993")


```

Column
-----------------------------------------------------------------------

### Explanation of TIV
```{r, echo = FALSE}
h3(renderText({
    "Explanation of Trend Indicator Value (TIV)"}))
  

renderText({
    "SIPRI statistical data on arms transfers relates to actual deliveries of major conventional weapons. To permit comparison between the data on such deliveries of different weapons and to identify general trends, SIPRI has developed a unique system to measure the volume of international transfers of major conventional weapons using a common unit, the trend-indicator value (TIV).

The TIV is based on the known unit production costs of a core set of weapons and is intended to represent the transfer of military resources rather than the financial value of the transfer."})
```

### World Map
```{r, echo = FALSE}
renderLeaflet({
  sd1 <- filter(sd, year == input$select_mapyear)
  sd2 <- filter(sd1, Region == input$select_top100region)
  
  clrs <- brewer.pal(9, "YlOrRd")

pal <- colorFactor(
  palette = clrs,
  domain = sd2$NAME
)

labels <- sprintf(
  "<strong>%s</strong>",
  sd2$NAME
) %>% lapply(htmltools::HTML)

  leaflet(filter(sd2, Region == input$select_top100region)) %>%
  addTiles() %>%
  addPolygons(stroke = FALSE, 
              smoothFactor = 0.2, 
              fillOpacity = 1, 
              color = ~pal(NAME), 
              highlight = highlightOptions(
                weight = 5,
                color = "#666",
                fillOpacity = 0.7,
                bringToFront = TRUE),
              label = labels,
              labelOptions = labelOptions(
                style = list("font-weight" = "normal", padding = "3px 8px"),
                textsize = "15px",
                direction = "auto"))
})
```

Column
-----------------------------------------------------------------------

### Description of Arms Imports by Region
```{r, echo = FALSE}
h3(renderText({
  if(input$select_top100region == "Sub-Saharan Africa"){
    "Sub-Saharan Africa"
  }else if(input$select_top100region == "South Asia"){
    "South Asia"
  }else if(input$select_top100region == "East Asia & Pacific"){
    "East Asia & Pacific"
  }else if(input$select_top100region == "Europe & Central Asia"){
    "Europe & Central Asia"
  }else if(input$select_top100region == "Latin America & Caribbean"){
    "Latin America & Caribbean"
  }else if(input$select_top100region == "Middle East & North Africa"){
    "Middle East & North Africa"
  }else{
    "North America"
  }
}))

renderText({
  if(input$select_top100region == "Sub-Saharan Africa"){
    "Out of the top 100 arms importing countries, 14 of them are from the Sub-Saharan African Region. From 1993 to 2017, the total arms import value for these countries amounted to 13,307 million TIV.
    
    South Africa is the top importer by value at an amount of 3,829 million TIV, while Namibia is the lowest ranked importer with an import value of 293 million TIV.
    
    Explore 20 years of Sub-Saharan African countries' import value by clicking on each country in the graph on the right."
  }else if(input$select_top100region == "South Asia"){
    "Out of the top 100 arms importing countries, four of them are from the South Asian Region. From 1993 to 2017, the total arms import value for these countries amounted to 81,045 million TIV.
    
    India is the top importer by value at an amount of 54,422 million TIV, while Afghanistan is the lowest ranked importer with an import value of 3,230 million TIV.
    
    Explore 20 years of South Asian countries' import value by clicking on each country in the graph on the right."
  }else if(input$select_top100region == "East Asia & Pacific"){
    "Out of the top 100 arms importing countries, 17 of them are from the East Asian & Pacific Region. From 1993 to 2017, the total arms import value for these countries amounted to 180,178 million TIV.
    
    China is the top importer by value at an amount of 41,751 million TIV, while Cambodia is the lowest ranked importer with an import value of 377 million TIV.
    
    Explore 20 years of East Asian & Pacific countries' import value by clicking on each country in the graph on the right."
  }else if(input$select_top100region == "Europe & Central Asia"){
    "Out of the top 100 arms importing countries, 34 of them are from the European & Central Asian Region. From 1993 to 2017, the total arms import value for these countries amounted to 132,608 million TIV.
    
    Turkey is the top importer by value at an amount of 26,353 million TIV, while Estonia is the lowest ranked importer with an import value of 322 million TIV.
    
    Explore 20 years of European & Central Asian countries' import value by clicking on each country in the graph on the right."
  }else if(input$select_top100region == "Latin America & Caribbean"){
    "Out of the top 100 arms importing countries, eight of them are from the Latin American & Caribbean Region. From 1993 to 2017, the total arms import value for these countries amounted to 29,815 million TIV.
    
    Brazil is the top importer by value at an amount of 6,161 million TIV, while Ecuador is the lowest ranked importer with an import value of 888 million TIV.
    
    Explore 20 years of Latin American & Caribbean countries' import value by clicking on each country in the graph on the right."
  }else if(input$select_top100region == "Middle East & North Africa"){
    "Out of the top 100 arms importing countries, 20 of them are from the Middle Eastern & North African Region. From 1993 to 2017, the total arms import value for these countries amounted to 155,817 million TIV.
    
    Saudi Arabia is the top importer by value at an amount of 35,352 million TIV, while Libya is the lowest ranked importer with an import value of 305 million TIV.
    
    Explore 20 years of Middle Eastern & North African countries' import value by clicking on each country in the graph on the right."
  }else{
    "Out of the top 100 arms importing countries, two of them are from the North American Region. From 1993 to 2017, the total arms import value for these countries amounted to 24,718 million TIV.
    
    United States is the top importer by value at an amount of 17,021 million TIV, while Canada is the lowest ranked importer with an import value of 7,697 million TIV.
    
    Explore 20 years of North American countries' import value by clicking on each country in the graph on the right."
  }
})
```

### Import Amount for Top 100 Importing Countries

```{r, echo = FALSE}
renderPlotly({
  if(input$select_top100region == "Sub-Saharan Africa"){
    p1 <- plot_ly(overviewshareddata_SSA, y=~amount, color=~NAME, type="box", height = 200)

    p2 <- plot_ly(overviewshareddata_SSA, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line", height = 200) 

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue') %>%
      layout(xaxis = list(tickangle = 45, tickfont = list(size = 10)))
  }
  else if(input$select_top100region == "South Asia"){
    p1 <- plot_ly(overviewshareddata_SA, y=~amount, color=~NAME, type="box", height = 250)

    p2 <- plot_ly(overviewshareddata_SA, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line", height = 250)

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
  else if(input$select_top100region == "East Asia & Pacific"){
    p1 <- plot_ly(overviewshareddata_EAP, y=~amount, color=~NAME, type="box")

    p2 <- plot_ly(overviewshareddata_EAP, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line")

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
  else if(input$select_top100region == "Europe & Central Asia"){
    p1 <- plot_ly(overviewshareddata_ECA, y=~amount, color=~NAME, type="box")

    p2 <- plot_ly(overviewshareddata_ECA, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line")

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
  else if(input$select_top100region == "Latin America & Caribbean"){
    p1 <- plot_ly(overviewshareddata_LAC, y=~amount, color=~NAME, type="box")

    p2 <- plot_ly(overviewshareddata_LAC, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line")

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
  else if(input$select_top100region == "Middle East & North Africa"){
    p1 <- plot_ly(overviewshareddata_MENA, y=~amount, color=~NAME, type="box")

    p2 <- plot_ly(overviewshareddata_MENA, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line")

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
  else{
    p1 <- plot_ly(overviewshareddata_NA, y=~amount, color=~NAME, type="box")

    p2 <- plot_ly(overviewshareddata_NA, x = ~year, y=~amount, alpha = 0.5, color=~NAME, type = "scatter", mode = "line")

    subplot(p1, p2, widths = c(0.5, 0.5)) %>%
      hide_legend() %>%
      highlight(dynamic = TRUE, color = 'blue')
  }
})
```


Visualization of Arms Dependencies
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Sidebar

```{r, echo = FALSE}
selectInput('select_region',"Select Region",
               choices = c("Sub-Saharan Africa","South Asia", "East Asia & Pacific", "Europe & Central Asia", "Latin America & Caribbean", "Middle East & North Africa"),
               selected = 'Sub-Saharan Africa')

selectInput('select_timeperiod', "Select Time Period",
            choices = c("1993 to 1997", "1998 to 2002", "2003 to 2007", "2008 to 2012", "2013 to 2017"),
            selected = '1993 to 1997')

selectInput('select_country', "Select Country on Tree Map",
            choices = c(unique(tradeFlows_summarised[, 5])),
            selected = unique(tradeFlows_summarised[1,5]))

```

Column {data-width=600}
-----------------------------------------------------------------------

### Chord Diagram

```{r, echo = FALSE}
renderChorddiag({
  if(input$select_timeperiod == "1993 to 1997"){
      if(input$select_region =="Sub-Saharan Africa"){
         chorddiag(chordSSA9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="South Asia"){
        chorddiag(chordSA9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="East Asia & Pacific"){
        chorddiag(chordEAP9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Europe & Central Asia"){
        chorddiag(chordECA9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Latin America & Caribbean"){
        chorddiag(chordLAC9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else{
         chorddiag(chordMENA9397_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")}
    }
  else if(input$select_timeperiod == "1998 to 2002"){
      if(input$select_region =="Sub-Saharan Africa"){
         chorddiag(chordSSA9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="South Asia"){
        chorddiag(chordSA9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="East Asia & Pacific"){
        chorddiag(chordEAP9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Europe & Central Asia"){
        chorddiag(chordECA9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Latin America & Caribbean"){
        chorddiag(chordLAC9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else{
         chorddiag(chordMENA9802_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")}
    }
  else if(input$select_timeperiod == "2003 to 2007"){
      if(input$select_region =="Sub-Saharan Africa"){
         chorddiag(chordSSA0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="South Asia"){
        chorddiag(chordSA0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="East Asia & Pacific"){
        chorddiag(chordEAP0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Europe & Central Asia"){
        chorddiag(chordECA0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Latin America & Caribbean"){
        chorddiag(chordLAC0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else{
         chorddiag(chordMENA0307_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")}
    }
  else if(input$select_timeperiod == "2008 to 2012"){
      if(input$select_region =="Sub-Saharan Africa"){
         chorddiag(chordSSA0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="South Asia"){
        chorddiag(chordSA0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="East Asia & Pacific"){
        chorddiag(chordEAP0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Europe & Central Asia"){
        chorddiag(chordECA0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Latin America & Caribbean"){
        chorddiag(chordLAC0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else{
         chorddiag(chordMENA0812_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")}
    }
  else{
      if(input$select_region =="Sub-Saharan Africa"){
         chorddiag(chordSSA1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="South Asia"){
        chorddiag(chordSA1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="East Asia & Pacific"){
        chorddiag(chordEAP1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Europe & Central Asia"){
        chorddiag(chordECA1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else if(
        input$select_region =="Latin America & Caribbean"){
        chorddiag(chordLAC1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")
      }else{
         chorddiag(chordMENA1317_agg, showTicks = F, groupnameFontsize = 12, groupnamePadding = 10, margin = 90, type = "directional")}
    }
})
```

### Treemap

```{r, echo = FALSE}
renderD3tree({
  d3tree(treemap(subset(tradeFlows_summarised, destCountries %in% input$select_country),
        index=c("Years", "origRegion", "origCountries"),
        vSize="Total Flows",
        vColor="Total Flows",
        palette="Reds",
        algorithm = "pivotSize",
        sortID = "Years",
        title="Pakistan Arms Import by Region and Country",
        title.legend = "Total Flows (USD millions)",
        aspRatio = NA
        ),rootname = paste(input$select_country, "Arms Imports (1993 to 2017)", sep = " "))
})


```


Visualization of Arms Trade Over Time
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Sidebar

```{r, echo = FALSE}
selectInput("select_region_ggridges", "Select Region", choices = levels(import1$Import_Region))
```

Column {.column}
-----------------------------------------------------------------------

### ggridges
```{r, echo = FALSE}
renderPlot({ 
  import2<-import1 %>% filter(Import_Region == input$select_region_ggridges)

ggplot(import2, aes(x = Value, y = Import_Countries)) + 
 
 geom_density_ridges(scale=1,alpha=0.6) +
  facet_grid(~Year_Range~Export_Region) +  scale_y_discrete(expand = c(0.01, 0)) +
  scale_x_continuous(expand = c(0, 0)) +  theme(strip.background = element_rect(fill="lightblue",size=1.5, linetype="solid")) +
   ggtitle("Trend In TIV Of Arms Imports from 1993 to 2017") + xlab("TIV of Arms Imports (In US$ Millions)") + ylab("Import Countries") + 
  theme(
plot.title = element_text(hjust = 0.5,color="#993333", size=18, face="bold"),
axis.title.x = element_text(size=14, face="bold"),
axis.title.y = element_text(size=14, face="bold")) 
  })

```








Visualization of Arms Import by FDI,GDP & Population Size
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Sidebar

```{r, echo = FALSE}
sliderInput("year_range_bubble", "Select year range",
              value = 2000, min = 1993, max = 2017, step = 1,width='100%',
                                   ticks=FALSE,
                                   sep="")

```

Column {.column}
-----------------------------------------------------------------------

### Bubble Plot

```{r, echo = FALSE}
renderPlotly({ 
  
  combined2<-combined1 %>% filter(Year==input$year_range_bubble)
    cols <- brewer.pal(n = 8, name = "YlOrRd")
  
plot_ly(combined2,x= ~`GDP Per Capita`, y= ~`FDI Net Inflow(100000s)`, type = "scatter",mode="markers", size= ~`TIV.of.arms.Imports`, color = ~`Total Population(100000s)`, colors = cols,  sizes = c(10, 50), marker = list(opacity = 0.8, sizemode = "diameter", line = list(width = 1, color = '#808080')), hoverinfo = 'text', text = ~paste('Region:', `Region`,'<br>Country:', `Country`, '<br>TIV of Arms Import:', format(`TIV.of.arms.Imports`,big.mark=",",sep=""),'<br>GDP Per Capita:', format(`GDP Per Capita`,,big.mark=",",sep=""),
              '<br>Foreign Direct Investment:', format(`FDI Net Inflow`,,big.mark=",",sep=""), '<br>Total Population:', format(`Total Population`,big.mark=",",sep=""))) %>%
        layout(title="Arms Imports versus Economic and Population Indicators",
        xaxis = list(range=c(0,45000),title = "GDP per capita (US$)",showgrid=FALSE, zerolinewidth = 1, ticklen = 5,
                      gridwidth = 2),
        yaxis = list(range=c(-20000,750000),title = "Foreign Direct Investment(US$ 100000)",showgrid=FALSE, zerolinewidth = 1, ticklen = 5, gridwith = 2),
        paper_bgcolor = 'rgb(230, 230, 230)',
        plot_bgcolor = 'rgb(230, 230, 230)')
})

```

Visualization of Arms Trade Network
=======================================================================

Sidebar {.sidebar}
-----------------------------------------------------------------------

### Sidebar

```{r, echo = FALSE}
selectInput('select_region_network',"Select Region",
               choices = c("Sub-Saharan Africa","South Asia", "East Asia & Pacific", "Europe & Central Asia", "Latin America & Caribbean", "Middle East & North Africa"),
               selected = 'Sub-Saharan Africa')

selectInput('select_timeperiod_network', "Select Time Period",
            choices = c("1993 to 2017", "1993 to 1997", "1998 to 2002", "2003 to 2007", "2008 to 2012", "2013 to 2017"),
            selected = '1993 to 2017')
```

Column {.column}
-----------------------------------------------------------------------

### Network Diagram

```{r, echo = FALSE}
renderVisNetwork({
  if(input$select_timeperiod_network == "1993 to 2017"){
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA9317_node_agg, netSSA9317_link, main = "Exports to Countries in Sub-Saharan Africa from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA9317_node_agg, netSA9317_link, main = "Exports to Countries in South Asia from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP9317_node_agg, netEAP9317_link, main = "Exports to Countries in East Asia & Pacific from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA9317_node_agg, netECA9317_link, main = "Exports to Countries in Europe & Central Asia from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC9317_node_agg, netLAC9317_link, main = "Exports to Countries in Latin America & Caribbean from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA9317_node_agg, netMENA9317_link, main = "Exports to Countries in Middle East & North Africa from 1993 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
  }
     else if(input$select_timeperiod_network == "1993 to 1997"){
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA9397_node_agg, netSSA9397_link, main = "Exports to Countries in Sub-Saharan Africa from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA9397_node_agg, netSA9397_link, main = "Exports to Countries in South Asia from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP9397_node_agg, netEAP9397_link, main = "Exports to Countries in East Asia & Pacific from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA9397_node_agg, netECA9397_link, main = "Exports to Countries in Europe & Central Asia from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC9397_node_agg, netLAC9397_link, main = "Exports to Countries in Latin America & Caribbean from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA9397_node_agg, netMENA9397_link, main = "Exports to Countries in Middle East & North Africa from 1993 to 1997") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
  }
       else if(input$select_timeperiod_network == "1998 to 2002"){
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA9802_node_agg, netSSA9802_link, main = "Exports to Countries in Sub-Saharan Africa from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA9802_node_agg, netSA9802_link, main = "Exports to Countries in South Asia from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP9802_node_agg, netEAP9802_link, main = "Exports to Countries in East Asia & Pacific from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA9802_node_agg, netECA9802_link, main = "Exports to Countries in Europe & Central Asia from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC9802_node_agg, netLAC9802_link, main = "Exports to Countries in Latin America & Caribbean from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA9802_node_agg, netMENA9802_link, main = "Exports to Countries in Middle East & North Africa from 1998 to 2002") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
       }
  else if(input$select_timeperiod_network == "2003 to 2007"){
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA0307_node_agg, netSSA0307_link, main = "Exports to Countries in Sub-Saharan Africa from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA0307_node_agg, netSA0307_link, main = "Exports to Countries in South Asia from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP0307_node_agg, netEAP0307_link, main = "Exports to Countries in East Asia & Pacific from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA0307_node_agg, netECA0307_link, main = "Exports to Countries in Europe & Central Asia from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC0307_node_agg, netLAC0307_link, main = "Exports to Countries in Latin America & Caribbean from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA0307_node_agg, netMENA0307_link, main = "Exports to Countries in Middle East & North Africa from 2003 to 2007") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
       }
       else if(input$select_timeperiod_network == "2008 to 2012"){
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA0812_node_agg, netSSA0812_link, main = "Exports to Countries in Sub-Saharan Africa from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA0812_node_agg, netSA0812_link, main = "Exports to Countries in South Asia from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP0812_node_agg, netEAP0812_link, main = "Exports to Countries in East Asia & Pacific from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA0812_node_agg, netECA0812_link, main = "Exports to Countries in Europe & Central Asia from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC0812_node_agg, netLAC0812_link, main = "Exports to Countries in Latin America & Caribbean from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA0812_node_agg, netMENA0812_link, main = "Exports to Countries in Middle East & North Africa from 2008 to 2012") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
       }
  else{
      if(input$select_region_network =="Sub-Saharan Africa"){
         visNetwork(netSSA1317_node_agg, netSSA1317_link, main = "Exports to Countries in Sub-Saharan Africa from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="South Asia"){
        visNetwork(netSA1317_node_agg, netSA1317_link, main = "Exports to Countries in South Asia from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="East Asia & Pacific"){
        visNetwork(netEAP1317_node_agg, netEAP1317_link, main = "Exports to Countries in East Asia & Pacific from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Europe & Central Asia"){
        visNetwork(netECA1317_node_agg, netECA1317_link, main = "Exports to Countries in Europe & Central Asia from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else if(
        input$select_region_network =="Latin America & Caribbean"){
        visNetwork(netLAC1317_node_agg, netLAC1317_link, main = "Exports to Countries in Latin America & Caribbean from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)
      }else{
         visNetwork(netMENA1317_node_agg, netMENA1317_link, main = "Exports to Countries in Middle East & North Africa from 2013 to 2017") %>%
          #visIgraphLayout() %>%
          visPhysics(solver = "barnesHut", stabilization = TRUE) %>%  
          visEdges(arrows = "to") %>%
            visOptions(highlightNearest = list(enabled = T, degree = 2, hover = T), nodesIdSelection = TRUE) %>%
            visGroups(groupname = "Sub-Saharan Africa", shape = "icon", icon = list(code = "f0ac", color = "grey")) %>%
            visGroups(groupname = "South Asia", shape = "icon", icon = list(code = "f0ac", color = "red")) %>%
            visGroups(groupname = "East Asia & Pacific", shape = "icon", icon = list(code = "f0ac", color = "green")) %>%
            visGroups(groupname = "Europe & Central Asia", shape = "icon", icon = list(code = "f0ac", color = "blue")) %>%
            visGroups(groupname = "Latin America & Caribbean", shape = "icon", icon = list(code = "f0ac", color = "black")) %>%
            visGroups(groupname = "Middle East & North Africa", shape = "icon", icon = list(code = "f0ac", color = "brown")) %>%
            visGroups(groupname = "North America", shape = "icon", icon = list(code = "f0ac", color = "lightblue")) %>%
            addFontAwesome() %>%
            visLegend(addNodes = list(
              list(label = "Sub-Saharan Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "grey")),
              list(label = "South Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "red")),
              list(label = "East Asia & Pacific", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "green")),
              list(label = "Europe & Central Asia", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "blue")),
              list(label = "Latin America & Caribbean", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "black")),
              list(label = "Middle East & North Africa", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "brown")),
              list(label = "North America", shape = "icon", 
                icon = list(code = "f0ac", size = 25, color = "lightblue"))),
              position = "right",
              useGroups = FALSE)}
       }
    }
)

```


